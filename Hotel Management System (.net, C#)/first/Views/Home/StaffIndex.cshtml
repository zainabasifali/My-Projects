@{
    ViewBag.Title = "StaffIndex";
    Layout = "~/Views/Shared/_StaffLayout.cshtml";
}
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" integrity="sha512-..." crossorigin="anonymous" referrerpolicy="no-referrer" />

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
    .card {
        background-color: #ffffff !important;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1) !important;
        border-color: #004d40;
        border-radius: 0.5rem;
        transition: transform 0.2s ease-in-out;
    }

        .card:hover {
            transform: translateY(-5px);
        }

    .card-body {
        padding: 1.5rem;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
    }

    .card-title {
        font-size: 1.2rem;
        font-weight: 600;
        margin-bottom: 0.75rem;
    }

    .card-text {
        font-size: 0.9rem;
    }

    .circular-chart {
        display: block;
        margin: 10px auto;
        max-width: 100%;
        max-height: 250px;
    }

    .circle-bg {
        fill: none;
        stroke: #eee;
        stroke-width: 3.8;
    }

    .circle {
        fill: none;
        stroke-width: 2.8;
        stroke-linecap: round;
        animation: progress 1s ease-out forwards;
    }

    .percentage {
        fill: #2e7d32;
        font-family: 'Arial', sans-serif;
        font-size: 0.6em;
        text-anchor: middle;
    }

    .progress {
        height: 35px;
        border-radius: 0.5rem;
        margin-bottom: 0.75rem;
        background-color: #e9ecef;
    }

    .progress-bar-leaves {
        background-color: #004d40; 
    }

    .progress-bar-duties {
        background-color: #004d40 !important;
        background-image: none !important; 
        opacity: 1 !important;
    }

    .progress-bar-attendance {
        background-color: #004d40; 
    }

    .badge {
        font-size: 0.9rem !important;
        padding: 0.5rem 0.75rem;
        border-radius: 0.3rem;
    }

    .fa-3x {
        font-size: 2.5em;
        margin-bottom: 1rem;
    }

    .text-leaves {
        color: #000 !important;
    }

    .text-duties {
        color: #000 !important;
    }

    .text-attendance {
        color: #000 !important;
    }
</style>

<div class="jumbotron bg-white shadow-sm p-4 rounded">
    <h2 class="display-5 text-dark">Staff Dashboard</h2>
    <p class="lead text-muted">Quick access to your daily tasks and information.</p>
    <hr class="my-4" />
    <p class="text-secondary">Manage duties, mark attendance, track inventory, handle bookings, and oversee room status.</p>
</div>

<div class="row mt-4">
    <!-- Leaves Left Card -->
    <div class="col-md-4 mb-4">
        <div class="card h-100">
            <div class="card-body text-center">
                <i class="fas fa-leaf fa-3x text-leaves mb-3"></i> 
                @{
                    int totalLeaves = 3;
                    int usedLeaves = totalLeaves - (int)ViewBag.LeavesLeft;
                    int leavePercentage = (int)(((double)(totalLeaves - usedLeaves) / totalLeaves) * 100);
                }
                <div class="circular-chart" style="width: 95px; height: 95px;margin-top:-15px">
                    <svg viewBox="0 0 36 36">
                        <path class="circle-bg"
                              d="M18 2.0845
                             a 15.9155 15.9155 0 0 1 0 31.831
                             a 15.9155 15.9155 0 0 1 0 -31.831" />
                        <path class="circle"
                              stroke="#004d40"
                              stroke-dasharray="@leavePercentage, 100"
                              d="M18 2.0845
                             a 15.9155 15.9155 0 0 1 0 31.831
                             a 15.9155 15.9155 0 0 1 0 -31.831" />
                        <text x="18" y="20.35" class="percentage">@ViewBag.LeavesLeft</text>
                    </svg>
                </div>
                <h5 class="card-title text-leaves">Leaves Left</h5>
                <p class="card-text text-muted small">Out of @totalLeaves allowed</p>
            </div>
        </div>
    </div>

    <!-- Pending Duties Card -->
    <div class="col-md-4 mb-4">
        <div class="card h-100">
            <div class="card-body text-center">
                <i class="fas fa-broom fa-3x text-duties mb-3"></i>
                @{
                    int maxDuties = 10;
                    int pending = (int)ViewBag.PendingDutiesCount;
                    int pendingPercent = Math.Min((int)(((double)pending / maxDuties) * 100), 100);
                }
                <div class="progress w-75 mt-3">
                    <div class="progress-bar progress-bar-duties" role="progressbar" style="width: @pendingPercent%;" aria-valuenow="@pendingPercent" aria-valuemin="0" aria-valuemax="100">
                        @pending
                    </div>
                </div>
                <h5 class="card-title text-duties mt-3">Pending Duties</h5>
                <p class="card-text text-muted small">Out of ~@maxDuties estimated</p>
            </div>
        </div>
    </div>

    <!-- Attendance Card -->
    <div class="col-md-4 mb-4">
        <div class="card h-100">
            <div class="card-body text-center">
                <i class="fas fa-calendar-check fa-3x text-attendance mb-3"></i>
                @if ((bool)ViewBag.AttendanceMarked)
                {
                    <span class="badge p-3 px-5 mt-2" style="background-color: #004d40">Marked</span>
                }
                else
                {
                    <span class="badge bg-danger p-3 px-5 mt-2">Not Marked</span>
                }
                <h5 class="card-title text-attendance mt-4">Today's Attendance</h5>
                <p class="card-text text-muted small">Remember to check in daily</p>
            </div>
        </div>
    </div>

</div>
